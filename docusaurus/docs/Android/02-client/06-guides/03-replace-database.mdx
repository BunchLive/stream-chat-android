# Replace Database

The offline support module uses Room as the ORM to handle persistence in the Stream Chat SDK, but it is possible to use a custom 
persistence library by injecting custom Repositories in the SDK. 

To show how to substitute Room to another ORM we elaborated a tutorial showing how to use Realm with Stream's SDK. With some modifications
in the code of this tutorial, you will able to use any other database.

## Using a custom RepositoryFactoryProvider

`ChatClient.Builder` allows the user to substitute the Repositories classes in the SDK. These classes are used by the entire 
SDK to access data from the database, so by changing then you will be able to use the database of your preference. You can call a 
`withRepositoryFactoryProvider`  with a custom implementation of `RepositoryFactory.Provider`. This is a functional interface that only provides 
[RepositoryFactory](https://github.com/GetStream/stream-chat-android/blob/main/stream-chat-android-client/src/main/java/io/getstream/chat/android/client/persistance/repository/factory/RepositoryFactory.kt):

```kotlin
val client = ChatClient.Builder(apiKey, context)
    .withRepositoryFactoryProvider { RealmRepositoryFactory(provideRealm()) }
    .build()
```

`RepositoryFactory` in the access point for all the `Repositories` of the SDK, so they must be provided by this interface:

```kotlin
public class RealmRepositoryFactory(private val realm: Realm) : RepositoryFactory {
    override fun createUserRepository(): UserRepository = RealmUserRepository(realm)

    override fun createChannelConfigRepository(): ChannelConfigRepository = RealmChannelConfigRepository(realm)

    override fun createQueryChannelsRepository(): QueryChannelsRepository = RealmQueryChannelsRepository(realm)

    override fun createSyncStateRepository(): SyncStateRepository = RealmSyncStateRepository(realm)

    override fun createAttachmentRepository(): AttachmentRepository = RealmAttachmentRepository(realm)

    override fun createReactionRepository(
        getUser: suspend (userId: String) -> User,
    ): ReactionRepository = RealmReactionRepository(realm)

    override fun createMessageRepository(
        getUser: suspend (userId: String) -> User,
    ): MessageRepository = RealmMessageRepository(realm)

    override fun createChannelRepository(
        getUser: suspend (userId: String) -> User,
        getMessage: suspend (messageId: String) -> Message?,
    ): ChannelRepository = RealmChannelRepository(realm)
}
```

